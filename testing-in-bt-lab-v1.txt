

BT lab access: ssh support@213.122.205.96
CLIENT_FQDN_OR_IP: 86.146.112.89 	#this is my house where the client VM sites
SERVER_IP: x.x.x.x			#BT FW public ip used for outbound traffic
					#get this from a trace
					#"ssh -p 9000 ops@86.146.112.89" then "sudo tcpdump -n -i ens3 port 9000"
VPN endpoint: 107.21.96.169		#openvpn.deepfield.net
#this pub key is in the DCU /home/support/.ssh/id_rsa/pub
SERVER_SSH_PUB_KEY=

========================================
Install server on the Master DCU (vlab):
========================================
git clone https://github.com/sigreen-nokia/remote-management-tsa.git
cd remote-management-tsa 
pip install -r ./requirements.txt
sudo python3 ./mgmt-access.py --install-server
---
CLIENT_SSH_TUNNEL_PORT not set yet (default 9000). Enter value or hit return to use default: 
Sep 07 21:57:57 mgmt-access.py [INFO]: SSH forwarding will use the +1 port: 9001
Sep 07 21:57:57 mgmt-access.py [INFO]: UI forwarding will use the +2 port: 9002
CLIENT_FQDN_OR_IP not set yet (default 10.20.30.40). Enter value or hit return to use default: 86.146.112.89  
---
sudo python3 ./mgmt-access.py --add-ops-user ---
Enter password for user 'ops': Testing123
Confirm password: Testing123

==============================
Install on the client: (local VM) 
==============================
git clone https://github.com/sigreen-nokia/remote-management-tsa.git
cd remote-management-tsa 
sudo python3 ./mgmt-access.py --add-ops-user
---
Enter password for user 'ops': Testing123
Confirm password: Testing123
---
sudo python3 ./mgmt-access.py --install-client
---
SERVER_IP not set yet (default 10.20.30.40). Enter value or hit return to use default: x.x.x.x 
CLIENT_SSH_TUNNEL_PORT not set yet (default 9000). Enter value or hit return to use default: 
Sep 07 21:51:37 mgmt-access.py [INFO]: SSH forwarding will use the +1 port: 9001
Sep 07 21:51:37 mgmt-access.py [INFO]: UI forwarding will use the +2 port: 9002
SSH_ALLOWED_IP not set yet (default 20.30.40.50). Enter value or hit return to use default: 107.21.96.169 
SSH_PUB_KEY not set yet (default ). Enter value or hit return to use default: 
Import additional public keys for the ops user from a file? [y/N]: n
Do you want to add another public SSH key for user 'ops'? [y/N]: n
Include 10.0.0.0/8? [y/N]: n
Include 172.16.0.0/12? [y/N]: n
Include 192.168.0.0/16? [y/N]: n
Add another (e.g., 203.0.113.0/24 or 203.0.113.5)? [y/N]: y
Enter IPv4 subnet or single IPv4 address: 192.168.1.138/32
Add another (e.g., 203.0.113.0/24 or 203.0.113.5)? [y/N]:n
'fail2ban' is not installed but is required. Do you want me to install it now? [y/N]:y
---

==============================
open up my firewalls  so the client can be assessed from the dcu.
==============================
BT adsl nat port 9000-9002 to mac of 192.168.1.170 
Synology NAS FW ports 9000 9001 9002 tcp

==============================
check the server (vlab) came up
==============================

sudo python3 ./mgmt-access.py --status
sudo python3 ./mgmt-access.py --status --log-level DEBUG

===============================
Testing:
===============================

#################
#Access the cluster via the client
##################
#openvn up
#add route (not required in prod)
sudo route add -host 86.146.112.89 -interface utun10
#ssh access via nat
ssh -p 9001 support@86.146.112.89
#ui access via nat
https://86.146.112.89:9002


